/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
INFO:tensorflow:Importing user module almond-nnparser-private from path /Users/Mehrad
INFO:tensorflow:Overriding hparams in transformer_tiny with batch_size=2048
WARNING:tensorflow:From /anaconda3/lib/python3.6/site-packages/tensor2tensor/utils/trainer_lib.py:165: RunConfig.__init__ (from tensorflow.contrib.learn.python.learn.estimators.run_config) is deprecated and will be removed in a future version.
Instructions for updating:
When switching to tf.estimator.Estimator, use tf.estimator.RunConfig instead.
INFO:tensorflow:schedule=continuous_train_and_eval
INFO:tensorflow:worker_gpu=1
INFO:tensorflow:sync=False
WARNING:tensorflow:Schedule=continuous_train_and_eval. Assuming that training is running on a single machine.
INFO:tensorflow:datashard_devices: ['gpu:0']
INFO:tensorflow:caching_devices: None
INFO:tensorflow:ps_devices: ['gpu:0']
INFO:tensorflow:Using config: {'_task_type': None, '_task_id': 0, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x1c26377438>, '_master': '', '_num_ps_replicas': 0, '_num_worker_replicas': 0, '_environment': 'local', '_is_chief': True, '_evaluation_master': '', '_train_distribute': None, '_tf_config': gpu_options {
  per_process_gpu_memory_fraction: 1.0
}
, '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_secs': None, '_log_step_count_steps': 100, '_session_config': gpu_options {
  per_process_gpu_memory_fraction: 0.95
}
allow_soft_placement: true
graph_options {
  optimizer_options {
  }
}
, '_save_checkpoints_steps': 1000, '_keep_checkpoint_max': 20, '_keep_checkpoint_every_n_hours': 10000, '_model_dir': '/Users/Mehrad/workdir/t2t_train/parse_almond/transformer-transformer_tiny', 'use_tpu': False, 't2t_device_info': {'num_async_replicas': 1}, 'data_parallelism': <tensor2tensor.utils.expert_utils.Parallelism object at 0x1c26377e48>}
WARNING:tensorflow:Estimator's model_fn (<function T2TModel.make_estimator_model_fn.<locals>.wrapping_model_fn at 0x1c263e8598>) includes params argument, but params are not passed to Estimator.
WARNING:tensorflow:ValidationMonitor only works with --schedule=train_and_evaluate
INFO:tensorflow:Running training and evaluation locally (non-distributed).
INFO:tensorflow:Start train and evaluate loop. The evaluate will happen after 600 secs (eval_spec.throttle_secs) or training is finished.
INFO:tensorflow:Reading data files from /Users/Mehrad/dataset/t2t_data/parse_almond-train*
INFO:tensorflow:partition: 0 num_data_files: 100
INFO:tensorflow:Calling model_fn.
INFO:tensorflow:Setting T2TModel mode to 'train'
INFO:tensorflow:Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_4605_128.bottom
INFO:tensorflow:Transforming 'targets' with symbol_modality_4605_128.targets_bottom
INFO:tensorflow:Building model body
INFO:tensorflow:Transforming body output with symbol_modality_4605_128.top
INFO:tensorflow:Base learning rate: 2.000000
INFO:tensorflow:Trainable Variables Total size: 1516672
INFO:tensorflow:Using optimizer Adam
/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py:100: UserWarning: Converting sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.
  "Converting sparse IndexedSlices to a dense Tensor of unknown shape. "
INFO:tensorflow:Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
2018-07-12 15:24:25.027086: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
INFO:tensorflow:Running local_init_op.
INFO:tensorflow:Done running local_init_op.
reading vocab_file: all_words.txt
Traceback (most recent call last):
  File "/anaconda3/bin/t2t-trainer", line 32, in <module>
    tf.app.run()
  File "/anaconda3/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 126, in run
    _sys.exit(main(argv))
  File "/anaconda3/bin/t2t-trainer", line 28, in main
    t2t_trainer.main(argv)
  File "/anaconda3/lib/python3.6/site-packages/tensor2tensor/bin/t2t_trainer.py", line 359, in main
    execute_schedule(exp)
  File "/anaconda3/lib/python3.6/site-packages/tensor2tensor/bin/t2t_trainer.py", line 306, in execute_schedule
    getattr(exp, FLAGS.schedule)()
  File "/anaconda3/lib/python3.6/site-packages/tensor2tensor/utils/trainer_lib.py", line 289, in continuous_train_and_eval
    self._eval_spec)
  File "/anaconda3/lib/python3.6/site-packages/tensorflow/python/estimator/training.py", line 439, in train_and_evaluate
    executor.run()
  File "/anaconda3/lib/python3.6/site-packages/tensorflow/python/estimator/training.py", line 518, in run
    self.run_local()
  File "/anaconda3/lib/python3.6/site-packages/tensorflow/python/estimator/training.py", line 650, in run_local
    hooks=train_hooks)
  File "/anaconda3/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py", line 363, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/anaconda3/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py", line 843, in _train_model
    return self._train_model_default(input_fn, hooks, saving_listeners)
  File "/anaconda3/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py", line 859, in _train_model_default
    saving_listeners)
  File "/anaconda3/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py", line 1059, in _train_with_estimator_spec
    _, loss = mon_sess.run([estimator_spec.train_op, estimator_spec.loss])
  File "/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py", line 567, in run
    run_metadata=run_metadata)
  File "/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py", line 1043, in run
    run_metadata=run_metadata)
  File "/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py", line 1119, in run
    return self._sess.run(*args, **kwargs)
  File "/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py", line 1183, in run
    feed_dict, options)
  File "/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/monitored_session.py", line 1209, in _call_hook_before_run
    request = hook.before_run(run_context)
  File "/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/basic_session_run_hooks.py", line 449, in before_run
    graph_def=graph.as_graph_def(add_shapes=True),
  File "/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3228, in as_graph_def
    result, _ = self._as_graph_def(from_version, add_shapes)
  File "/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3182, in _as_graph_def
    [output.get_shape().as_proto() for output in op.outputs])
  File "/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3182, in <listcomp>
    [output.get_shape().as_proto() for output in op.outputs])
  File "/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/tensor_shape.py", line 911, in as_proto
    for d in self._dims
  File "/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/tensor_shape.py", line 911, in <listcomp>
    for d in self._dims
KeyboardInterrupt
